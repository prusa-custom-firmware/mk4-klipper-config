# Do not edit this file!
# You can override settings from this file by adding a section of the same name
# in printer.cfg or another file included from it after the base configuration.

# The xBuddy board contains a circuit which latches if any fault is detected,
# so persists across reboots (if power is retained). In Buddy Firmware this
# latch is reset during a boot interstitial.
#
# For Klipper, configuring an output pin like this allows the user to reset
# the fault easily in the UI, and optionally script it on startup.

[output_pin fault_reset]
pin: !PG7
value: 0
shutdown_value: 0

[gcode_button current_fault]
pin: PG6
press_gcode:
  FIRMWARE_RESTART

[gcode_button heater_fault]
pin: PG5
press_gcode:
  FIRMWARE_RESTART

# The xBuddy board also contains current and voltage measurement circuits, but
# there isn't an obvious way in Klipper to configure these. This example
# configuration should work with a simple plugin like the one discussed at
# https://klipper.discourse.group/t/feature-generic-analog-inputs/22074
#
#[analog_input input_current]
## (((rawValue * 3.35) / 1023) - (3.35 / 2)) * (1/0.09)
## src/hw/mk4_ix/hw_configuration.cpp
#offset: -18.611
#scale: 37.222
#unit: A
#sensor_pin: PF4
#[analog_input heater_current]
#scale: 3.435897 # ((rawValue * 3.35 / 1023) / 1.95) * 2, advanced_power.hpp
#unit: A
#sensor_pin: PF3
#
#[analog_input heater_voltage]
#scale: 36.85 # (rawValue * 3.35) / 1023)) * ((10k + 1k) / 1k) , advanced_power.hpp
#unit: V
#sensor_pin: PA3
#
#[analog_input bed_voltage]
#scale: 36.85 # (rawValue * 3.35) / 1023)) * ((10k + 1k) / 1k) , advanced_power.hpp
#unit: V
#sensor_pin: PA5
#limit1: 24.0
##under_limit1_gcode:
##  M117 Low
##over_limit1_gcode:
##  M117 Normal
