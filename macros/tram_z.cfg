[gcode_macro TRAM_Z]
gcode:
  {% if "xyz" not in printer.toolhead.homed_axes %}
  G28
  {% endif %}
  _CLIENT_LINEAR_MOVE X=125 F=6000 ABSOLUTE=1
  _CLIENT_LINEAR_MOVE Z=210 F=1440 ABSOLUTE=1
  {% set cur = printer.configfile.settings['tmc2130 stepper_z'].run_current %}
  SET_TMC_CURRENT STEPPER=stepper_z CURRENT=0.3
  FORCE_MOVE STEPPER=stepper_z DISTANCE=30 VELOCITY=4
  SET_TMC_CURRENT STEPPER=stepper_z CURRENT={cur}
  FORCE_MOVE STEPPER=stepper_z DISTANCE=-217.5 VELOCITY=24
  G28
